\chapter{Single population growth models}
\label{chap:single_pop_growth}



\section{Objectives}
We are given a table with the population census at different time intervals between a date $a$ and a date $b$, and want to get an expression for the population. This allows us to: 
\begin{itemize}
\item compute a value for the population at any time between the date $a$ and the date $b$ (\textbf{interpolation}),
\item predict a value for the population at a date before $a$ or after $b$ (\textbf{extrapolation}).
\end{itemize}

%\begin{figure}[htbp]
%\begin{center}
%\includegraphics[width=0.7\textwidth]{../figs_02_population_growth/titre_PearlReed1920PNAS6}
%\end{center}
%\end{figure}

This was studied in a series of papers in the 1920-40's, mainly under the influence of Pearl and Reed \cite{PearlReed1920,PearlReed1930,PearlReedFish1940}.


\section{The data: US census}
% \begin{figure}[htbp]
% \begin{center}
% \includegraphics[width=0.8\textwidth]{../figs_02_population_growth/table_PearlReed1920PNAS6}
% \end{center}
% \end{figure}



\begin{table}[htbp]
\begin{center}
\begin{tabular}{cc}
Year & Population\\
& (millions) \\
\hline
1790 & 3.929 \\
1800 & 5.308 \\
1810 & 7.240 \\
1820 & 9.638 \\
1830 & 12.866 \\
1840 & 17.069 \\
1850 & 23.192 \\
1860 & 31.443 \\
1870 & 38.558 \\
1880 & 50.156 \\
1890 & 62.948 \\
1900 & 75.995 \\
1910 & 91.972 
\end{tabular}
\caption{The US population from 1790 to 1910. From Pearl and Reed
\cite{PearlReed1920}.}
\label{table:US_population_1790_1910}
\end{center}
\end{table}

Using MatLab (or Octave), create two vectors using commands such as
\begin{verbatim}
t=1790:10:1910;
\end{verbatim}
Format is
\begin{center}
Vector=Initial value:Step:Final value
\end{center}
(semicolumn hides result of the command.)
\begin{verbatim}
P=[3929214,5308483,7239881,9638453,12866020, ...
    17069453,23191876,31443321,38558371,50155783, ...
    62947714,75994575,91972266];
\end{verbatim}
Here, elements were just listed ({\tt ...} indicates that the line continues below).
Then plot using
\begin{verbatim}
plot(t,P);
\end{verbatim}
\begin{center}
\includegraphics[width=0.5\textwidth]{../figs_02_population_growth/USpop_to1910}
\end{center}
To get points instead of a line, use the command
\begin{verbatim}
plot(t,P,'*');
\end{verbatim}
\begin{center}
\includegraphics[width=0.5\textwidth]{../figs_02_population_growth/USpop_to1910_points}
\end{center}

\subsection{A quadratic curve?}
The curve looks like a piece of a parabola. So let us fit a curve of the form
\[
P(t)=a+bt+ct^2.
\]
To do this, we want to minimize
\[
S=\sum_{k=1}^{13} \left(P(t_k)-P_k\right)^2,
\]
where $t_k$ are the known dates, $P_k$ are the known populations, and $P(t_k)=a+bt_k+ct_k^2$.
We proceed as in the notes (but note that the role of $a,b,c$ is reversed):
\[
S=S(a,b,c)=\sum_{k=1}^{13} \left(a+bt_k+ct_k^2-P_k\right)^2
\]
is maximal if (necessary condition) $\partial S/\partial a=\partial S/\partial b=\partial S/\partial c=0$, with
\begin{align*}
\frac{\partial S}{\partial a} &= 2\sum_{k=1}^{13}(a+bt_k+ct_k^2-P_k) \\
\frac{\partial S}{\partial b} &= 2\sum_{k=1}^{13}(a+bt_k+ct_k^2-P_k)t_k \\
\frac{\partial S}{\partial c} &= 2\sum_{k=1}^{13}(a+bt_k+ct_k^2-P_k)t_k^2
\end{align*}
So we want
\begin{align*}
2\sum_{k=1}^{13}(a+bt_k+ct_k^2-P_k) &= 0\\
2\sum_{k=1}^{13}(a+bt_k+ct_k^2-P_k)t_k &= 0 \\
2\sum_{k=1}^{13}(a+bt_k+ct_k^2-P_k)t_k^2 &= 0,
\end{align*}
that is
\begin{align*}
\sum_{k=1}^{13}(a+bt_k+ct_k^2-P_k) &= 0\\
\sum_{k=1}^{13}(a+bt_k+ct_k^2-P_k)t_k &= 0 \\
\sum_{k=1}^{13}(a+bt_k+ct_k^2-P_k)t_k^2 &= 0.
\end{align*}
Rearranging the system, we get
\begin{align*}
\sum_{k=1}^{13}(a+bt_k+ct_k^2) &= \sum_{k=1}^{13}P_k\\
\sum_{k=1}^{13}(at_k+bt_k^2+ct_k^3) &= \sum_{k=1}^{13}P_kt_k\\
\sum_{k=1}^{13}(at_k^2+bt_k^3+ct_k^4) &= \sum_{k=1}^{13}P_kt_k^2.
\end{align*}
After a bit of tidying up, we get
\begin{align*}
\left(\sum_{k=1}^{13}1\right)a+\left(\sum_{k=1}^{13}t_k\right)b+\left(\sum_{k=1}^{13}t_k^2\right)c &= \sum_{k=1}^{13}P_k \\
\left(\sum_{k=1}^{13}t_k\right)a+\left(\sum_{k=1}^{13}t_k^2\right)b+\left(\sum_{k=1}^{13}t_k^3\right)c &= \sum_{k=1}^{13}P_kt_k \\
\left(\sum_{k=1}^{13}t_k^2\right)a+\left(\sum_{k=1}^{13}t_k^3\right)b+\left(\sum_{k=1}^{13}t_k^4\right)c &= \sum_{k=1}^{13}P_kt_k^2.
\end{align*}
So the aim is to solve the linear system
\[
\begin{pmatrix}
13 & \sum\limits_{k=1}^{13}t_k & \sum\limits_{k=1}^{13}t_k^2 \\
\sum\limits_{k=1}^{13}t_k & \sum\limits_{k=1}^{13}t_k^2 & \sum\limits_{k=1}^{13}t_k^3 \\
\sum\limits_{k=1}^{13}t_k^2 & \sum\limits_{k=1}^{13}t_k^3 & \sum\limits_{k=1}^{13}t_k^4
\end{pmatrix}
\begin{pmatrix}
a\\ b\\ c
\end{pmatrix}
=
\begin{pmatrix}
\sum\limits_{k=1}^{13}P_k \\
\sum\limits_{k=1}^{13}P_kt_k \\
\sum\limits_{k=1}^{13}P_kt_k^2
\end{pmatrix}
\]
With MatLab (or Octave), getting the values is easy.
\begin{itemize}
\item To apply an operation to every element in a vector or matrix, prefix the operation with a dot, hence
\begin{verbatim}
 t.^2;
\end{verbatim}
gives, for example, the vector with every element $t_k$ squared. 
\item Also, the function {\tt sum} gives the sum of the entries of a vector or matrix.
\item When entering a matrix or vector, separate entries on the same row by {\tt ,} and create a new row by using {\tt ;}.
\end{itemize}
Thus, to set up the problem in the form of solving $Ax=b$, we need to do the
following:
\begin{verbatim}
format long g;
A=[13,sum(t),sum(t.^2);sum(t),sum(t.^2),sum(t.^3);...
sum(t.^2),sum(t.^3),sum(t.^4)];
b=[sum(P);sum(P.*t);sum(P.*(t.^2))];
\end{verbatim}
The {\tt format long g} command is used to force the display of digits (normally, what is shown is in ``scientific'' notation, not very informative here). 

Then, solve the system using
\begin{verbatim}
A\b
\end{verbatim}
We get the following output:
\begin{verbatim}
>> A\b
Warning: Matrix is close to singular or badly scaled.
         Results may be inaccurate. RCOND = 1.118391e-020.

ans =
        22233186177.8195
        -24720291.325476
        6872.99686313725
\end{verbatim}
(note that here, Octave gives a solution that is not as good as this one, provided by MatLab).


\subsection{Checking our results for the quadratic}
Thus
\[
P(t)=22233186177.81-24720291.32t+6872.99t^2
\]
To see what this looks like,
\begin{verbatim}
plot(t,22233186177.81-24720291.32.*t+6872.99.*t.^2);
\end{verbatim}
(note the dots before multiplication and power, since we apply this function to every entry of $t$).
In fact, to compare with original data:
\begin{verbatim}
plot(t,22233186177.81-24720291.32.*t+6872.99.*t.^2,t,P,'*');
\end{verbatim}
\begin{figure}[htbp]
\begin{center}
\includegraphics[width=0.5\textwidth]
{../figs_02_population_growth/quadratic_fit}
\end{center}
\end{figure}




Now we want to generate the table of values, to compare with the true values and thus compute the error. To do this, we can proceed directly:
\begin{verbatim}
computedP=22233186177.81-24720291.32.*t+6872.99.*t.^2;
\end{verbatim}
We get
\begin{verbatim}
computedP =

 Columns 1 through 4:
      5633954.39      5171628.52      6083902.03    8370774.90

 Columns 5 through 8:
      12032247.15      17068318.78      23478989.77    31264260.14

 Columns 9 through 12:
       40424129.88      50958598.99      62867667.48    76151335.34

 Column 13:
      90809602.57
\end{verbatim}

We can also create an \textbf{inline} function
\begin{verbatim}
f=inline('22233186177.81-24720291.32.*t+6872.99.*t.^2')
f =
     Inline function:
     f(t) = 22233186177.81-24720291.32.*t+6872.99.*t.^2
\end{verbatim}
This function can then easily be used for a single value
\begin{verbatim}
octave:24> f(1880)
ans =     50958598.9969215
\end{verbatim}
as well as for vectors.

(Recall that $t$ has the dates; $t$ in the definition of the function is a dummy
variable, we could have used another letter-.)
\begin{verbatim}
octave:25> f(t)
ans =

 Columns 1 through 4:
      5633954.39      5171628.52      6083902.03    8370774.90

 Columns 5 through 8:
      12032247.15      17068318.78      23478989.77    31264260.14

 Columns 9 through 12:
       40424129.88      50958598.99      62867667.48    76151335.34

 Column 13:
      90809602.57
\end{verbatim}
Form the vector of errors, and compute sum of errors squared:
\begin{verbatim}
octave:26> E=f(t)-P;
octave:27> sum(E.^2)
ans =     12186176863781.4
\end{verbatim}
Quite a large error (12,186,176,863,781.4), which is normal since we have used actual numbers, not thousands or millions of individuals, and we are taking the square of the error.

To present things legibly, one way is to put everything in a matrix..
\begin{verbatim}
M=[P;f(t);E;E./P];
\end{verbatim}
This matrix will have each type of information as a row, so to display it in the form of a table, show its transpose, which is achieved using the function {\tt transpose} or the operator $'$.
{\footnotesize
\begin{verbatim}
M'
ans =
 3929214      5633954.39552689      1704740.39552689     0.433862954658842
 5308483      5171628.52739334     -136854.472606659   -0.0257803354756263
 7239881      6083902.03188705     -1155978.96811295    -0.159668227711608
 9638453      8370774.90901184     -1267678.09098816    -0.131522983095748
12866020      12032247.1587601     -833772.841239929   -0.0648042550252471
17069453      17068318.7811356     -1134.21886444092  -6.644728828e-05
23191876      23478989.7761383      287113.776138306    0.0123799289086534
31443321      31264260.1437798     -179060.856220245  -0.00569471832254123
38558371       40424129.884037      1865758.88403702    0.0483879073635403
50155783      50958598.9969215      802815.996921539    0.0160064492846526
62947714      62867667.4824371     -80046.5175628662  -0.00127163502018304
75994575      76151335.3405762      156760.340576172   0.00206278330494212
91972266      90809602.5713463     -1162663.42865372    -0.012641456813228
\end{verbatim}
}

\frame{\frametitle{Now for the big question...}
How does our formula do for present times?
\begin{verbatim}
f(2006)
ans =     301468584.066013
\end{verbatim}
Actually, quite well: 301,468,584, compared to the 298,444,215 July 2006 estimate, overestimates the population by 3,024,369, a relative error of approximately 1\%.
}

\frame{\frametitle{The US population from 1790 to 2000 (revised numbers)}
\begin{center}
\begin{tabular}[t]{ccc}
\begin{tabular}{cc}
Year & Population\\
& (millions) \\
\hline
1790 & 3.929 \\
1800 & 5.308 \\
1810 & 7.240 \\
1820 & 9.638 \\
1830 & 12.866 \\
1840 & 17.069 \\
1850 & 23.192 \\
1860 & 31.443 \\
1870 & 38.558 \\
1880 & 50.156 \\
1890 & 62.948
\end{tabular} 
&\quad &
\begin{tabular}{cc}
Year & Population \\
& (millions) \\
\hline
1900 & 76.212 \\
1910 & 92.228 \\
1920 & 106.021 \\
1930 & 123.202 \\
1940 & 132.164 \\
1950 & 151.325 \\
1960 & 179.323 \\
1970 & 203.302 \\
1980 & 226.542 \\
1990 & 248.709 \\
2000 & 281.421
\end{tabular}
\end{tabular}
\end{center}
}

\subsection{Other similar approaches}
Pritchett, 1891:
\[
P=a+bt+ct^2+dt^3.
\]
(we have done this one, and found it to be quite good too).
Pearl, 1907:
\[
P(t)=a+bt+ct^2+d\ln t.
\]
Finds
\[
P(t)=9,064,900-6,281,430t+842,377t^2+19,829,500\ln t.
\]
}

% \frame{
% \begin{center}
% \includegraphics[width=0.95\textwidth]{../figs_02_population_growth/table2_PearlReed1920PNAS6}
% \end{center}
% }


\subsection{The logistic curve}
Pearl and Reed try
\[
P(t)=\frac{be^{at}}{1+ce^{at}}
\]
or
\begin{equation}\label{eq:logistic_curve}
P(t)=\frac{b}{e^{-at}+c}.
\end{equation}
They find
\[
P(t)=\frac{2,930.3009}{e^{-0.0313395t}+0.014854}.
\]

\section{The logistic equation}
\label{sec:ODE_logistic}

The \emph{logistic curve} \eqref{eq:logistic_curve} is the solution to the \emph{ordinary differential equation}
\begin{equation}\label{eq:ODE_logistic}
N'=rN\left(1-\frac NK\right),
\end{equation}
which is called the \textbf{logistic equation}. $r$ is the \textbf{intrinsic growth rate}, $K$ is the \textbf{carrying capacity}.
This equation was introduced by Pierre-Fran\c{c}ois Verhulst
(1804-1849) \cite{Verhulst1838,Verhulst1845}.
The idea is to represent a population with the following components:
\begin{itemize}
\item birth, at the \textbf{per capita} rate $b$,
\item death, at the \textbf{per capita} rate $d$,
\item competition of individuals with other individuals reduces their ability to survive, resulting in death.
\end{itemize}
This gives
\[
N'=bN-dN-\textrm{competition}.
\]
Competition describes the mortality that occurs when two individuals meet:
\begin{itemize}
\item
In chemistry, if there is a concentration $X$ of one product and $Y$ of another product, then $XY$, called \textbf{mass action}, describes the number of interactions of molecules of the two products.
\item
Here, we assume that $X$ and $Y$ are of the same type (individuals). So there are $N^2$ contacts.
\item 
These $N^2$ contacts lead to death of one of the individuals at the rate $c$.
\end{itemize}
Therefore, the \textbf{logistic} equation is
\[
N'=bN-dN-cN^2.
\]


\paragraph{Reinterpreting the logistic equation}
The equation
\[
N'=bN-dN-cN^2
\]
is rewritten as
\[
N'=(b-d)N-cN^2.
\]
\begin{itemize}
\item $b-d$ represents the rate at which the population increases (or decreases) in the absence of competition. It is called the \textbf{intrinsic growth rate} of the population.
\item $c$ is the rate of \textbf{intraspecific} competition. The prefix \textbf{intra} refers to the fact that the competition is occurring between members of the same species, that is, within the species.\newline
[We will see later examples of \textbf{interspecific} competition, that is, between different species.]
\end{itemize}



\frame{\frametitle{Another (..) interpretation of the logistic equation}
We have
\[
N'=(b-d)N-cN^2.
\]
Factor out an $N$:
\[
N'=\bigl((b-d)-cN\bigr)N.
\]
This gives us another interpretation of the logistic equation. Writing
\[
\frac{N'}N=(b-d)-cN,
\]
we have $N'/N$, the \textbf{per capita growth rate} of $N$, given by a constant, $b-d$, minus a \textbf{density dependent inhibition} factor, $cN$.
}

\frame{\frametitle{Equivalent equations}
\begin{align*}
N' &= (b-d)N-cN^2\\
&= \bigl((b-d)-cN\bigr)N \\
&= \left(r-\frac rr cN\right)N,\quad\textrm{with }r=b-d \\
&= rN\left(1-\frac crN\right) \\
&= rN\left(1-\frac NK\right),
\end{align*}
with
\[
\frac cr=\frac 1K,
\]
that is, $K=r/c$.
}

\frame{\frametitle{3 ways to tackle this equation}
\begin{enumerate}
\item The equation is separable. [explicit method]
\item The equation is a Bernoulli equation. [explicit method]
\item Use qualitative analysis.
\end{enumerate}
}


\subsection{Qualitative analysis of the logistic equation}
We study
\begin{equation}\label{eq:logistic_ode}
N'=rN\left(1-\frac NK\right).
\end{equation}
For this, write
\[
f(N)=rN\left(1-\frac NK\right).
\]
Consider the initial value problem (IVP) 
\begin{equation}\label{ivp:logistic_ode}
N'=f(N),\quad N(0)=N_0>0.
\end{equation}
\begin{itemize}
\item $f$ is $C^1$ (differentiable with continuous derivative) so solutions to \eqref{ivp:logistic_ode} exist and are unique.
\end{itemize}
\textbf{Equilibria} of \eqref{eq:logistic_ode} are points such that $f(N)=0$ (so
that $N'=f(N)=0$, meaning $N$ does not vary). So we solve $f(N)=0$ for $N$. We
find two points:
\begin{itemize}
\item $N=0$
\item $N=K$.
\end{itemize}
By uniqueness of solutions to \eqref{ivp:logistic_ode}, solutions cannot cross the lines $N(t)=0$ and $N(t)=K$.

There are several cases.
\begin{itemize}
\item $N=0$ for some $t$, then $N(t)=0$ for all $t\geq 0$, by uniqueness of solutions.
\item $N\in(0,K)$, then $rN>0$ and $N/K<1$ so $1-N/K>0$, which implies that $f(N)>0$. As a consequence, $N(t)$ increases if $N\in(0,K)$.
\item $N=K$, then $rN>0$ but $N/K=1$ so $1-N/K=0$, which implies that $f(N)=0$. As a consequence, $N(t)=K$ for all $t\geq 0$, by uniqueness of solutions.
\item $N>K$, the $rN>0$ and $N/K>1$, implying that $1-N/K<0$ and in turn, $f(N)<0$. As a consequence, $N(t)$ decreases if $N\in(K,+\infty)$.
\end{itemize}
Therefore,
\begin{theorem}
Suppose that $N_0>0$. Then the solution $N(t)$ of \eqref{ivp:logistic_ode} is such that
\[
\lim_{t\to\infty} N(t)=K,
\]
so that $K$ is the number of individuals that the environment can support, the \textbf{carrying capacity} of the environment.

If $N_0=0$, then $N(t)=0$ for all $t\geq 0$.
\end{theorem}


\section{The delayed logistic equation}
\label{sec:DDE_logistic}
Consider the equation as
\[
\frac{N'}{N}=(b-d)-cN,
\]
that is, the per capita rate of growth of the population depends on the net growth rate $b-d$, and some density dependent inhibition $cN$ (resulting of competition).
Suppose that instead of instantaneous inhibition, there is some delay $\tau$ between the time the inhibiting event takes place and the moment when it affects the growth rate.
For example, two individuals fight for food, and one later dies of the injuries sustained during this fight.

In the case of a time $\tau$ between inhibiting event and inhibition, the equation would be written as
\[
\frac{N'}N=(b-d)-cN(t-\tau).
\]
Using the change of variables introduced earlier, this is written
\begin{equation}\label{eq:logistic_dde}
N'(t)=rN(t)\left(1-\frac{N(t-\tau)}K\right).
\end{equation}
Such an equation is called a \textbf{delay} differential equation. It is much more complicated to study than \eqref{eq:logistic_ode}. In fact, some things remain unknown about \eqref{eq:logistic_dde}.

\paragraph{Delayed initial value problem}
The IVP takes the form
\begin{equation}\label{ivp:logistic_dde}
\begin{aligned}
N'(t)&= rN(t)\left(1-\frac{N(t-\tau)}K\right),\\
N(t) &= \phi(t)\textrm{ for }t\in[-\tau,0],
\end{aligned}
\end{equation}
where $\phi(t)$ is some continuous function. Hence, initial conditions (called initial data in this case) must be specified on an interval, instead of being specified at a point, to guarantee existence and uniqueness of solutions.

We will not learn how to study this type of equation (this is graduate level mathematics). I will give a few results.

\vskip0.5cm
To find equilibria, remark that delay should not play a role, since $N$ should be constant. Thus, equilibria are found by considering the equation with no delay, which is \eqref{eq:logistic_ode}.
\begin{theorem}
Suppose that $r\tau<\pi/2$. Then solutions of \eqref{ivp:logistic_dde} with positive initial data $\phi(t)$ starting close enough to $K$ tend to $K$. If $r\tau<37/24$, then all solutions of  \eqref{ivp:logistic_dde} with positive initial data $\phi(t)$ tend to $K$. If $r\tau>\pi/2$, then $K$ is an unstable equilibrium and all solutions of \eqref{ivp:logistic_dde} with positive initial data $\phi(t)$ on $[-\tau,0]$ are oscillatory.
\end{theorem}
There is a gray zone between $37/24$ ($\simeq 1.5417$) and $\pi/2$ ($\simeq 1.5708$). The global aspect was proved for $r\tau<37/24$ in 1945 by Wright. Although there is very strong numerical evidence that this is in fact true up to $\pi/2$, nobody has yet managed to prove it.

\section{The logistic map}
\label{sec:DE_logistic}

So far, we have seen continuous-time models, where $t\in\IR$ (usually, $t\in\IR_+$). Another way to model natural phenomena is by using a discrete-time formalism, that is, to consider equations of the form
\[
x_{t+1}=f(x_t),
\]
where $t\in\IN$ or $\IZ$, that is, $t$ takes values in a discrete valued (countable) set.
Time could for example be days, years, etc. This is called a \textbf{discrete-time system}, or a \textbf{difference equation}.
Some notions of theory for difference equations is given in Section~\ref{sec:theory_maps}.

The logistic \textbf{map} is, for $t\geq 0$,
\begin{equation}\label{eq:logistic_discrete}
N_{t+1}=rN_t\left(1-\frac{N_t}K\right).
\end{equation}
To transform this into an initial value problem, we need to provide an initial condition $N_0\geq 0$ for $t=0$.
For convenience we rewrite \eqref{eq:logistic_discrete} as
\begin{equation}\label{eq:logistic_discrete_scaled}
x_{t+1}=rx_t(1-x_t),
\end{equation}
where $r$ is a parameter in $\IR_+$, and $x$ is typically taken in $[0,1]$. We let
\begin{equation}\label{eq:logistic_map}
f_r(x)=rx1-x).
\end{equation}
This defines the discrete time logistic equation
\begin{equation}
x_{t+1}=f_r(x_t), \label{eq:logistic}
\end{equation}
the latter being considered with initial condition $x_0\in[0,1]$.

\subsection{Well-posedness}
We consider the case $0<r<4$, where we know for certain that the iterates of $f_r$ remain in the set $[0,1]$. Indeed, 
\begin{equation}\label{eq:dlogistic_map}
f_r'(x)=r-2r x=r(1-2x),
\end{equation}
so $f_r$ is increasing for $x<1/2$ and decreasing for $x>1/2$, with a maximum at $x=1/2$, equal to $r/4$. On the other hand, $f_r(0)=f_r(1)=0$, so the minima are at $x=0$ and $x=1$. Therefore, if $r<4$ then $f_r([0,1])\subset[0,1]$.

\begin{itemize}
\item Note that if $x_0=0$, then $x_t=0$ for all $t\geq 1$. 
\item Similarly, if $x_0=1$, then $x_1=0$, and thus $x_t=0$ for all $t\geq 1$.
\item This is true for all $t$: if there exists $t_k$ such that $x_{t_k}=1$, then $x_t=0$ for all $t\geq t_k$.
\item This last case might occur if $r=4$, as we have seen.
\item Also, if $r=0$ then $x_t=0$ for all $t$.
\end{itemize}
For these reasons, we generally consider $x\in(0,1)$
and $r\in(0,4)$.






\subsection{Fixed points of $f_r$}
Fixed points of \eqref{eq:logistic_map} are found by solving the fixed point equation
\[
f_r(x)=x,
\]
that is,
\[
r x(1-x)=x.
\]
It is clear that there are two points that satisfy this equation, namely $x=0$ and $x=(r-1)/r$. We denote from now on $p=(r-1)/r$.

Note that $x=0$ always exists. On the other hand, $p$ has the following properties:
\begin{itemize}
\item $\lim_{r\to 0^+}p=-\infty$.
\item $\dfrac{\partial}{\partial r}p=\dfrac{1}{r^2}>0$, so $p$ is an increasing function of $r$.
\item $p=0$ if and only if $r=1$ (unique since $p$ is increasing).
\item $\lim_{r\to\infty}p=1$.
\end{itemize}
Remember that we are modelling a population, so we want $p>0$ (or at least, nonnegative). If $p>0$, we say that $p$ is \emph{biologically relevant}. For this, we need $r>1$. In the case that $r<1$, then $p$ does exist, but we do not consider it, as it is not biologically relevant, and by abuse of language, say that $p$ does not exist.

\vskip0.5cm
\noindent{\bf Conclusion 1.} At this point, the situation is as follows. The fixed point $x=0$ always exists, and
\begin{itemize}
\item if $r\in(0,1)$, then $p$ does not exist,
\item if $r>1$, then $p$ exists.
\end{itemize}


\subsection{Stability of the fixed points}
To determine the stability of $f_r$ at a fixed point $x^*$, we need to compare $|f'_r(x^*)|$ with the value 1. From \eqref{eq:dlogistic_map},
\[
|f'_r(0)|=|r|=r,
\]
and
\begin{align*}
|f'_r(p)| &= \left|r-2r\dfrac{r-1}{r}\right|\\
&= |r-2(r-1)| \\
&= |2-r|.
\end{align*}
As a consequence, $x=0$ is attracting if $r<1$ and repelling otherwise, and $p=(r-1)/r$ is attracting if $|2-r|<1$, that is, $r<3$, and repelling otherwise.

\begin{center}
\includegraphics[width=0.5\textwidth]
{../figs_02_population_growth/bif_cascade_1}
\end{center}

\vskip0.5cm
\noindent{\bf Conclusion 2.} Building upon {\bf Conclusion 1}, we therefore deduce that
\begin{itemize}
\item if $r\in(0,1)$, then $x=0$ is attracting, and the fixed point $x=p$ does not exist,
\item if $r\in(1,3)$, then $x=0$ is repelling, and the fixed point $x=p$ exists and is attracting,
\item if $r>3$, then $x=0$ is repelling, and the fixed point $x=p$ exists and is repelling.
\end{itemize}


\begin{remark}
A fixed point that is such that $|f'(p)|\neq 1$, or a periodic point such that $|(f^k)'(p)|\neq 1$, is called \emph{hyperbolic}. In the case that $|f'(p)|=1$, or, for a periodic point, $|(f^k)'(p)|=1$, then $p$ is called \emph{non hyperbolic}. The non hyperbolic case is harder to treat. Here, the case $r=1$ is a \emph{non hyperbolic} case. However, the probability that $r=1$ is zero (the set $r=\{1\}$ has measure zero in the parameter space $\IR_+$), explaining why, most of the time, the case $r=1$ is omitted.
\end{remark}



\subsection{Stable sets of the fixed points}
{\bf Conclusion 2} establishes that $x=0$ and $x=p$ are attracting when, respectively, $r\in(0,1)$ and $r\in(1,3)$. This is not sufficient to characterize the behavior of all solutions. Remember that attractiveness of a fixed point $x^*$ implies that there is a neighborhood of $x^*$ that belongs to $W^s(x^*)$, i.e., there exists 
a neighborhood $\mathcal{N}\ni x^*$ such that $\forall x\in\mathcal{N}$, $x$ is forward asymptotic to $x^*$.

If we want to make sure that we have the ``complete picture'', we need to show that $W^s(x^*)=[0,1]$, i.e., that all solutions go to $x^*$. There are several ways to tackle this problem, only one is shown here.

\subsubsection{Case of the fixed point $x=0$ (i.e., case $0<r<1$)}
Since $r<1$, it follows that $f_r(x)=r x(1-x)<x(1-x)$ Also, $x\in[0,1]$ implies that $1-x\in[0,1]$, and therefore $f_r(x)<x(1-x)\leq x$. Therefore, for any $x_0\in[0,1]$,
\begin{align*}
x_1 &= f_r(x_0) \\
&< x_0 \\
x_2 &= f_r(x_1) \\
& < x_1.
\end{align*}
Therefore we have a strictly decreasing sequence. Since $[0,1]$ is invariant, the sequence is bounded below by $0$. Therefore $\lim_{k\to\infty}f^k(x_0)=0$, and $W^s(0)=[0,1]$ when $0<r<1$. Therefore we can strengthen {\bf Conclusion 2}.

\noindent{\bf Conclusion 3$'$.} If $0<r<1$, then for all $x_0\in[0,1]$, $\lim_{k\to\infty}f^k(x_0)=0$, or, equivalently, $\lim_{t\to\infty}x_t=0$.

\begin{remark}
In the considerations above, we could have used Theorem~\ref{th:gas_1} directly, once it was established that $f_r(x)<x$.
\end{remark}
 

\subsubsection{Case of the fixed point $x=p$ (i.e., case $1<r<3$)}
We know that $f_r$ is increasing from a minimum of 0 at $x=0$ to a maximum $r/4$ at $x=1/2$, and then decreasing from there to a minimum of 0 at $x=1$. Therefore, we must distinguish two cases: $r<2$ and $r>2$.


\paragraph{Case $1<r<2$}
In the case $r<2$, the intersection of $f_r(x)$ with the first bisectrix $x$ occurs before the maximum $r/4$ is reached (see Figure~\ref{fig:logistic_1dot5}).
\begin{figure}[htbp]
\begin{center}
\includegraphics[width=0.5\textwidth]{../figs_02_population_growth/logistic_1dot5}
\end{center}
\caption{The function $f_{1.5}(x)$.}\label{fig:logistic_1dot5}
\end{figure}
Then we are in a position to use part {\bf a} in Theorem~\ref{th:gas_4}, giving the conclusion.

\paragraph{Case $2<r<3$}
In the case $r>2$, the intersection of $f_r(x)$ with the first bisectrix $x$ occurs after the maximum $r/4$ is reached (see Figure~\ref{fig:logistic_2dot5}).
\begin{figure}[htbp]
\begin{center}
\includegraphics[width=0.5\textwidth]{../figs_02_population_growth/logistic_2dot5}
\end{center}
\caption{The function $f_{2.5}(x)$.}\label{fig:logistic_2dot5}
\end{figure}
We use Theorem~\ref{th:gas_2} in Appendix~\ref{sec:global_stability}. In order to be able to apply this theorem, we must first prove that there are no 2-cycles. For this purpose, we could try to use Theorem~\ref{th:no_cycles}, but it fails to provide the conclusion here. Here, we can use the result from Section~\ref{sec:2cycles}, where it is shown by explicit calculation that there are no 2-cycles for $r<3$.
It is clear that $f$ satisfies the hypotheses of Theorem~\ref{th:gas_2}. Indeed, $f$ is decreasing for $x>1/2$.

\begin{remark}
We could also have used part {\bf b} in Theorem~\ref{th:gas_4}, but this required to show that $f^2(x)>x$ for $x\in(1/2,p)$.
\end{remark}


\paragraph{Case $r=2$}
The result used to treat the case $r<2$ can, in the present case, be extended to include the case where $r=2$.


% Here, the first idea would be to show the following:
% \begin{itemize}
% \item if $x_0\in(0,p)$, then $\{x_k\}$ is an increasing sequence,
% \item if $x_0\in(p,1)$, then $\{x_k\}$ is a decreasing sequence.
% \end{itemize}
% Note, however, that this is not sufficient: clearly, nothing forbids the sequence from ``jumping'' from one side of $p$ to the other. This is easy to see using cobwebbing: choosing $x_0$ such that $f_\mu(x_0)>p$ is not difficult (if suffices to choose $x_0$ such that $f_\mu(x_0)$ is above the line $y=p$). We thus want to show that the jumps take us closer and closer to $p$.
% 
% To do this, we consider the interval $I_0=(\varepsilon,1)$, with $\varepsilon>0$ small. We have $f_\mu'(0)=\mu>1$, and by continuity of $f_\mu'$, it is therefore possible to choose $\varepsilon$ small enough that $f_\mu'(\varepsilon)=\mu(1-2\varepsilon)>1$.



\subsection{Points of period 2}
\label{sec:2cycles}
We now study the existence of periodic points with least period 2, that is, fixed points of the map $f_r^2(x)$. We have
\begin{align}
f_r^2(x) &= f_r(f_r(x)) \nonumber\\
&= r f_r(x)(1-f_r(x)) \nonumber\\
&= r^2 x(1-x)(1-r x(1-x)). \label{eq:f_mu_2_a}
\end{align}
Remark that 0 and $p$ are points of period 2. Indeed, a fixed point $x^*$ of $f$ satisfies $f(x^*)=x^*$, and as a consequence, $f^2(x^*)=f(f(x^*))=f(x^*)=x^*$. This is extremely helpful in localizing the other periodic points, if there are any. Indeed, writing the fixed point equation as
\[
f_r^2(x)-x=0,
\]
and defining $Q(x):=f_r^2(x)-x$, we see that, since $0$ and $p$ are fixed points of $f_r^2$, they are roots of $Q(x)$. Therefore, $Q$ can be factorized as
\[
Q(x)=x(x-p)(-r^3x^2+Bx+C),
\]
since it is clear from \eqref{eq:f_mu_2_a} that $f_r^2$ is a polynomial of degree 4 with leading coefficient equal to $-r^3$. Substituting the value $(r-1)/r$ for $p$ in $Q$, developing $Q$ and \eqref{eq:f_mu_2_a} and equating coefficients of like powers gives
\begin{equation}\label{eq:Q}
Q(x)=x\left(x-\frac{r-1}{r}\right)\left(-r^3 x^2+r^2(r+1)x-r(r+1)\right).
\end{equation}
The roots of \eqref{eq:Q} are the fixed points of $f_r^2$. Since $x=0$ and $x=p$ are already known, we can concentrate on the roots of the polynomial
\[
R(x):=-r^3 x^2+r^2(r+1)x-r(r+1).
\]
The discriminant is $\Delta=r^4(r+1)^2-4r^4(r+1)=r^4(r+1)(r+1-4)=r^4(r+1)(r-3)$. Therefore, $R$ has distinct real roots if $r>3$, and a double real root if $r=3$. In the latter case, the root is
\[
\frac{-r^2(r+1)}{-2r^3}=\frac{r+1}{2r}=\frac 23,
\]
which is the value of $p$ when evaluated at $r=3$: the fixed point $p$ and the fixed point deduced from $R$ coincide at $r=3$.

\vskip1cm
So we now consider the case $r>3$. In this case, $R$ has two distinct real roots (that is, $f_r^2$ has two distinct real fixed points). More than their actual value, what is of interest is 
\begin{enumerate}
\item are these roots positive,
\item are these roots smaller than 1.
\end{enumerate}
If one or both of them is not in $(0,1)$, it will indeed have to be considered as non biologically relevant and ignored.

First, remark that for $r>3$ but very close to 3, it follows from the continuity of $R$ that the roots are in $(0,1)$.
To show that this is still the case as we move away from 3, we use Descartes' rule of signs (Theorem~\ref{th:descartes}, Section~\ref{sec:descartes}). For this, remark that $R$ has signed coefficients $-+-$, giving two sign changes and the possibility of 0 or 2 positive real roots. On the other hand, $R(-x)$ has signed coefficients $---$, hence there are no negative real roots. As we are in the case where the roots are real, it follows that both roots are positive.

To show that the roots are also smaller than 1, consider the change of variables $z=x-1$. The polynomial $R$ is transformed into 
\begin{align*}
R_2(z) &= -r^3 (z+1)^2+r^2(r+1)(z+1)-r(r+1) \\
&= -r^3z^2+r^2(1-r)z-r.
\end{align*}
For $r>1$, all the coefficients of this polynomial are negative, implying that $R_2$ has no root $z>0$, implying in turn that $R$ has no root $x>1$.


% \section{Attractiveness of the periodic orbits}
% \[
% \left(f_\mu^2\right)'(x)=-\mu^2(2x-1)(2\mu x^2-2\mu x+1)
% \]

\begin{figure}[htbp]
\begin{center}
\includegraphics[width=0.5\textwidth]
{../figs_02_population_growth/bif_cascade_3}

\end{center}
\end{figure}
%\begin{center}
%\includegraphics[width=0.5\textwidth]{../figs_02_population_growth/bif_cascade_4}
%\end{center}






\begin{figure}[htbp]
\begin{center}
\includegraphics[width=0.6\textwidth]{../figs_02_population_growth/cascade_29_4}
\caption{Bifurcation cascade for $2.9\leq r\leq 4$.}
\end{center}
\end{figure}


\subsection{The cascade of bifurcation to chaos}
\label{sec:chaos}
The logistic map undergoes a sequence of period doubling bifurcations, called the \textbf{period-doubling cascade}, as $r$ increases from 3 to 4.

\begin{itemize}
\item Every successive bifurcation leads to a doubling of the period.
\item The bifurcation points form a sequence, $\{r_n\}$, that has the property that
\[
\lim{n\to\infty}\frac{r_n-r_{n-1}}{r_{n+1}-r_n}
\]
exists and is a constant, called the Feigenbaum constant, equal to 4.669202\ldots
\item This constant has been shown to exist in many of the maps that undergo the same type of cascade of period doubling bifurcations.
\end{itemize}


Sharkovskii's ordering of integers is as follows:
\begin{gather*}
3\triangleright 5\triangleright 7 \triangleright 9 \triangleright 11\triangleright \cdots \triangleright 2\cdot 3\triangleright  2\cdot 5\triangleright \cdots \triangleright 2\cdot 9\triangleright\cdots\triangleright 2^2\cdot 3\triangleright 2^2\cdot 5\triangleright \cdots \\
\triangleright 2^n\cdot 3\triangleright 2^n\cdot 5\triangleright \cdots\triangleright 2^{n+1}\cdot 3\triangleright 2^{n+1}\cdot 5\triangleright \cdots
\triangleright 2^{n+1}\triangleright 2^n\triangleright \cdots 2^2 \triangleright 2\triangleright 1.
\end{gather*}
This gives an ordering between all positive integers. The following result helps characterizing the behavior of the cascade.
\begin{theorem}[Sharkovskii]\label{th:sharkovskii}
Let $f:I\subset\IR\to\IR$ be a continuous function. Assume that $f$ has a point of least period $n$ and $n\triangleright k$. Then $f$ has a point of least period $k$.
\end{theorem}


\begin{figure}[htbp]
\begin{center}
\includegraphics[width=0.5\textwidth]
{../figs_02_population_growth/analysis_logistic_cascade_full}
\end{center}
\caption{The cascade of bifurcation to chaos for the logistic map.}
\end{figure}

After a certain value of $r$, there are periodic points with all periods. In particular, there are periodic points of period 3. 
By Sarkovskii's theorem, the presence of period 3 points implies the presence of points of all periods.
At this point, the system is said to be in a \textbf{chaotic regime}, or \textbf{chaotic}.




\section{Conclusion}

We have used three different modelling paradigms to describe the growth of a population in a \textbf{logistic} framework:
\begin{itemize}
\item The ODE version of Section~\ref{sec:ODE_logistic} has monotone solutions converging to the carrying capacity $K$.
\item The DDE version of Section~\ref{sec:DDE_logistic} has oscillatory solutions, either converging to $K$ or, if the delay is too large, periodic about $K$.
\item The discrete time version of Section~\ref{sec:DE_logistic} has all sorts of behaviors, and can be chaotic.
\end{itemize}
It is important to be aware that the {\bf choice of modelling method} is almost {\bf as important} in the outcome of the model as the precise formulation/hypotheses of the {\bf model}.


%\section{Critic of the logistic equation in the US census case}
%
%\frame{\frametitle{What is wrong with the logistic equation here?}
%\begin{itemize}
%\item The carrying capacity is constant.
%\item The model does not take immigration into account (for the US, this is an important component).
%\end{itemize}
%}
%
%
%\section{Population curves -- Gompertz}
%
%\frame{
%\begin{center}
%\includegraphics[width=0.95\textwidth]{title_Winsor1932PNAS18}
%\end{center}
%}
%
%\frame{
%\begin{center}
%\includegraphics[width=0.95\textwidth]{table_Winsor1932PNAS18}
%\end{center}
%}
%


\section{Some theory for maps}
\label{sec:theory_maps}
Suppose that we have a discrete-time system of the form
\begin{equation}\label{sys:discret}
x_{t+1}=f(x_t),
\end{equation}
with initial condition given for $t=0$ by $x_0$. Then,
\begin{align*}
x_1 &= f(x_0) \\
x_2 &= f(x_1)= f(f(x_0))\stackrel{\Delta}{=} f^2(x_0) \\
& \vdots \\
x_k &= f^k(x_0).
\end{align*}
The compositions
\[
f^k=\underbrace{f\circ f\circ\cdots\circ f}_{k\textrm{ times}}
\]
are called the \textbf{iterates} of $f$.
They define an infinite sequence of points
\[
x_0,x_1,x_2,\ldots,x_t,\ldots,
\]
that constitute the \textbf{solution} to system \eqref{sys:discret}. We would like to know what happens to this solution. For example, in the case of the logistic map \eqref{eq:logistic_map}, do solutions behave like they do for the continuous time logistic equation \eqref{eq:ODE_logistic} and tend to the carrying capacity $K$?

\subsection{Fixed points}
For that, as in the continuous time case, we first seek equilibrium solutions, that is, solutions for which no variation occurs. Because of the type of equation that arises when seeking such solutions, equilibrium solutions are usually called fixed points, in the context of discrete-time systems.

\begin{definition}[Fixed point]
Let $f$ be a function. A point $p$ such that $f(p)=p$ is called a \textbf{fixed point} of $f$.
\end{definition}
The existence of fixed points is guaranteed in a relatively general situation by the following two theorems.
\begin{theorem}
Consider the closed interval $I=[a,b]$. If $f:I\to I$ is continuous, then $f$ has a fixed point in $I$.
\end{theorem}
\begin{theorem}
Let $I$ be a closed interval and $f:I\to\IR$ be a continuous function. If $f(I)\supset I$, then $f$ has a fixed point in $I$.
\end{theorem}

\begin{definition}[Periodic point]
Let $f$ be a function. If there exists a point $p$ and an integer $n$ such that
\[
f^n(p)=p,\quad\textrm{but}\quad f^k(p)\neq p\textrm{ for }k<n,
\]
then $p$ is a periodic point of $f$ with (least) period $n$ (or a $n$-periodic point of $f$).
\end{definition}
\vskip0.5cm
Thus, $p$ is a $n$-periodic point of $f$ iff $p$ is a $1$-periodic point of $f^n$.


\subsection{Local stability of fixed points and periodic points}
\begin{theorem}
Let $f$ be a continuously differentiable function (that is, differentiable with continuous derivative, or $C^1$), and $p$ be a fixed point of $f$. 
\begin{enumerate}
\item If $|f'(p)|<1$, then there is an open interval $\mathcal{I}\ni p$ such that $\lim_{k\to\infty}f^k(x)=p$ for all $x\in\mathcal{I}$.
\item If $|f'(p)|>1$, then there is an open interval $\mathcal{I}\ni p$ such that if $x\in\mathcal{I}$, $x\neq p$, then there exists $k$ such that $f^k(x)\not\in\mathcal{I}$.
\end{enumerate}
\end{theorem}
\begin{definition}
Suppose that $p$ is a $n$-periodic point of $f$, with $f\in C^1$. 
\begin{itemize}
\item If $|\left(f^n\right)'(p)|<1$, then $p$ is an \textbf{attracting} periodic point of $f$. 
\item If $|\left(f^n\right)'(p)|>1$, then $p$ is an \textbf{repelling} periodic point of $f$.
\end{itemize}
\end{definition}

\subsection{Bifurcations}
Consider an equation 
\begin{equation}
x_{t+1}=f_r(x_t),
\end{equation}
where $r$ is a parameter in $\IR$.
The function $f_r$ is called a \textbf{parametrized family} of functions.


\begin{definition}[Bifurcation]
Let $f_\mu$ be a parametrized family of functions. Then there is a \textbf{bifurcation} at $\mu=\mu_0$ (or $\mu_0$ is a bifurcation point) if there exists $\varepsilon>0$ such that, if $\mu_0-\varepsilon<a<\mu_0$ and $\mu_0<b<\mu_0+\varepsilon$, then the dynamics of $f_a(x)$ are ``different'' from the dynamics of $f_b(x)$.
\end{definition}
\vskip0.5cm
An example of ``different'' would be that $f_a$ has a fixed point (that is, a 1-periodic point) and $f_b$ has a 2-periodic point.

\subsection{Global stability}
\label{sec:global_stability}
The results presented here come from \cite{Allen2007}. We use the words \emph{equilbrium} and \emph{fixed point} interchangeably. Throughout this Section, we consider the discrete time scalar equation
\begin{equation}
x_{t+1}=f(x_t) \tag{\ref{sys:discret}}
\end{equation}
induced by the mapping $f$.

\begin{definition}[Globally attractive fixed point]
Suppose that $\bar x$ is a fixed point of $f$,
where $f: [0,a)\rightarrow [0,a),$ $0<a\leq \infty$. Then $\bar x$ is said to be \emph{globally attractive} if for all initial conditions $x_0\in (0,a)$, $$\lim_{t\rightarrow \infty}x_t=\bar x.$$
\end{definition}

\begin{definition}[Globally asymptotically stable fixed point]
The fixed point is said to be \emph{globally asymptotically stable} if $\bar x$ is globally attractive and if $\bar x$ is locally stable.
\end{definition}
Globally attractive equilibria are locally attractive, therefore globally asymptotically stable equilibria are locally asymptotically stable.


\begin{theorem}\label{th:gas_1}
If the function $f$ satisfies
\begin{enumerate}
\item $f$ is continuous on $[0,a),$ $0<a\leq \infty$,
\item $f: [0,a)\rightarrow [0,a),$ $0<a\leq \infty$,
\item $0<f(x)<x$ for all $x\in [0,a)$,
\end{enumerate}
then the origin is globally asymptotically stable for \eqref{sys:discret}.
\end{theorem}

\begin{theorem}\label{th:gas_2}
The difference equation \eqref{sys:discret}, with $f$ satisfying 
\begin{enumerate}
\item $f$ is continuous on $[0,a),$ $0<a\leq \infty$,
\item $f: [0,a)\rightarrow [0,a),$ $0<a\leq \infty$,
\item $f(0)=0$, $f(\bar x)=\bar x$ ,
\item $f(x)>x$ for $0<x<\bar x$,
\item $f(x)<x$ for $\bar x<x<a$,
\item if $f$ has a maximum at $x_M$ in $(0,\bar x)$, then $f$ is decreasing for $x>x_M$,
\end{enumerate}
has a globally asymptotically stable equilibrium at $\bar x$ if and only if has no 2-cycles.
\end{theorem}

To prove that there are no 2-cycles, the next result is helpful.
\begin{theorem}\label{th:no_cycles}
Let $f'$ be continuous on an interval $I$ and $f: I\rightarrow I$. If $1+f'(x)\not =0$ for all $x\in I$ then \eqref{sys:discret} has no $2-cycles$ in $I$.
\end{theorem}

\begin{theorem}\label{th:gas_3}
If $f$ satisfies
\begin{enumerate}
\item $f$ is continuous on $[0,a),$ $0<a\leq \infty$,
\item $f: [0,a)\rightarrow [0,a),$ $0<a\leq \infty$,
\item $\bar x \in (0,a)$ such that $x<f(x)<\bar x$ for $0<x<\bar x$
and $\bar x<f(x)< x$ for $x>\bar x$
\end{enumerate}
then the difference equation \eqref{sys:discret} has a globally asymptotically stable equilibrium at $\bar x$.
\end{theorem}

\begin{theorem}\label{th:gas_4}
Consider the difference equation \eqref{sys:discret}.
\begin{description}
\item[a.]Suppose that $f$ satisfies
\begin{enumerate}
\item $f$ is continuous on $[0,a),$ $0<a\leq \infty$,
\item $f: [0,a)\rightarrow [0,a),$ $0<a\leq \infty$,
\item $f(0)=0$, $f(\bar x)=\bar x$ 
\item $f(x)>x$ for $0<x<\bar x$
\item $f(x)<x$ for $\bar x<x<a$
\end{enumerate}
but has no maximum in $(0,\bar x)$. Then $\bar x$ is globally asymptotically stable.
\item[b.]Suppose that $f$ satisfies
\begin{enumerate}
\item $f$ is continuous on $[0,a),$ $0<a\leq \infty$,
\item $f: [0,a)\rightarrow [0,a),$ $0<a\leq \infty$,
\item $f(0)=0$, $f(\bar x)=\bar x$ 
\item $f(x)>x$ for $0<x<\bar x$
\item $f(x)<x$ for $\bar x<x<a$
\item if $f$ has a maximum at $x_M$ in $(0,\bar x)$, then $f$ is decreasing for $x>x_M$
\end{enumerate}
has a maximun $x_M$ in $(0,\bar x)$. Then $\bar x$ is globally asymptotically stable if and only if $f^2(x)>x$ for all $x\in [x_M,\bar x)$
\end{description}
\end{theorem}

